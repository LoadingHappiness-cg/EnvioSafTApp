<Window x:Class="EnvioSafTApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:EnvioSafTApp.Converters"
        Title="Envio SAF-T AT" Height="800" Width="1300" WindowStartupLocation="CenterScreen"
        MinWidth="1200"
        MinHeight="750">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:TickerTypeToColorConverter x:Key="TickerTypeToColorConverter"/>
    </Window.Resources>

    <Grid Background="#F5F7FA">
        <Grid.RowDefinitions>
            <RowDefinition Height="88"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="40"/>
        </Grid.RowDefinitions>

        <!-- Cabe√ßalho -->
        <Border Grid.Row="0" Padding="20,12" CornerRadius="0,0,14,14" >
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#FF4FA3E6" Offset="0"/>
                    <GradientStop Color="#FF6BC8F4" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Background="#1AFFFFFF" Padding="10" CornerRadius="12" Margin="0,0,10,0">
                        <Image x:Name="Logo" Source="/EnviaSaft.png" Height="42"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Envio SAF-T AT" Foreground="White" FontSize="18" FontWeight="Bold"/>
                        <TextBlock Text="Aplica√ß√£o gratuita para envio de SAF-T para a AT" Foreground="#E0F3FF" FontSize="12" Margin="0,2,0,0"/>
                    </StackPanel>
                </StackPanel>

                <Button Grid.Column="2"
                        Content="‚úâÔ∏è ENVIAR"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Command="{Binding EnviarCommand}"
                        Margin="0,0,12,0"
                        Padding="18,10"
                        FontWeight="SemiBold"
                        VerticalAlignment="Center"/>

                <Border Grid.Column="3" Background="#26FFFFFF" Padding="12,8" CornerRadius="12" VerticalAlignment="Center">
                    <TextBlock Text="{Binding AppVersion}"
                               Foreground="White"
                               FontSize="12"
                               FontWeight="SemiBold"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>
                </Border>
            </Grid>
        </Border>

        <!-- Conte√∫do principal -->
        <Grid Grid.Row="1" Margin="20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1.6*" MinWidth="520"/>
                <ColumnDefinition Width="8"/>
                <ColumnDefinition Width="0.9*" MinWidth="420"/>
            </Grid.ColumnDefinitions>

            <!-- Coluna Esquerda (formul√°rio) -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <!-- Dados do Envio -->
                    <GroupBox Header="üìã Dados do Envio" Style="{StaticResource ModernGroupBoxStyle}" Margin="0,0,0,15">
                        <StackPanel Margin="15">
                            <!-- Ano, M√™s, Opera√ß√£o -->
                            <Grid Margin="0,0,0,15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="1.5*"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                    <TextBlock Text="Ano *" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox x:Name="AnoTextBox"
                                            Text="{Binding Ano, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{StaticResource ModernTextBoxStyle}"
                                            Height="34"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                    <TextBlock Text="M√™s *" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox x:Name="MesTextBox"
                                            Text="{Binding Mes, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{StaticResource ModernTextBoxStyle}"
                                            Height="34"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="Opera√ß√£o *" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <ComboBox x:Name="OperacaoComboBox"
                                             SelectedValue="{Binding Operacao}"
                                             SelectedValuePath="Content"
                                             Style="{StaticResource ModernComboBoxStyle}"
                                             Height="34">
                                        <ComboBoxItem Content="validar"/>
                                        <ComboBoxItem Content="enviar" IsSelected="True"/>
                                    </ComboBox>
                                </StackPanel>
                            </Grid>

                            <!-- NIF e Password -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                    <TextBlock Text="NIF *" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <TextBox x:Name="NifTextBox"
                                            Text="{Binding Nif, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{StaticResource ModernTextBoxStyle}"
                                            Height="34"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="Password *" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                    <PasswordBox x:Name="PasswordBox"
                                                PasswordChanged="PasswordBox_PasswordChanged"
                                                Style="{StaticResource ModernPasswordBoxStyle}"
                                                Height="34"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </GroupBox>

                    <!-- Ficheiro SAF-T -->
                    <GroupBox Header="üìÅ Ficheiro SAF-T" Style="{StaticResource ModernGroupBoxStyle}" Margin="0,0,0,15">
                        <StackPanel Margin="15">
                            <TextBlock Text="Ficheiro *" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="FicheiroTextBox"
                                        Text="{Binding FicheiroSafT, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{StaticResource ModernTextBoxStyle}"
                                        Height="38"
                                        Grid.Column="0"/>
                                <Button Content="üìÇ"
                                       Style="{StaticResource ModernIconButtonStyle}"
                                       Width="38"
                                       Height="38"
                                       Margin="8,0,0,0"
                                       Grid.Column="1"
                                       FontSize="16"
                                       Command="{Binding BrowseFileCommand}"/>
                            </Grid>
                            
                            <!-- Checkboxes -->
                            <StackPanel Orientation="Horizontal" Margin="0,15,0,0">
                                <CheckBox x:Name="TesteCheckBox" 
                                         IsChecked="{Binding IsTeste}" 
                                         Content="Envio de Teste" 
                                         Margin="0,0,25,0"
                                         VerticalAlignment="Center"/>
                                <CheckBox x:Name="AutoFaturacaoCheckBox" 
                                         IsChecked="{Binding IsAutoFaturacao}" 
                                         Content="Autofatura√ß√£o"
                                         VerticalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>

                    <!-- Op√ß√µes Avan√ßadas -->
                    <GroupBox Header="‚öôÔ∏è Op√ß√µes Avan√ßadas" Style="{StaticResource ModernGroupBoxStyle}">
                        <StackPanel Margin="15">
                            <!-- Password do Arquivo -->
                            <TextBlock Text="Password do Arquivo" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <PasswordBox x:Name="ArquivoPasswordBox"
                                        PasswordChanged="ArquivoPasswordBox_PasswordChanged"
                                        Style="{StaticResource ModernPasswordBoxStyle}"
                                        Height="34"
                                        Margin="0,0,0,12"/>

                            <!-- NIF Emitente -->
                            <TextBlock Text="NIF Emitente" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <TextBox x:Name="NifEmitenteTextBox"
                                    Text="{Binding NifEmitente, UpdateSourceTrigger=PropertyChanged}"
                                    Style="{StaticResource ModernTextBoxStyle}"
                                    Height="34"
                                    Margin="0,0,0,12"/>

                            <!-- Ficheiro de Retorno -->
                            <TextBlock Text="Ficheiro de Retorno" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <Grid Margin="0,0,0,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="OutputTextBox"
                                        Text="{Binding OutputFile, UpdateSourceTrigger=PropertyChanged}"
                                        Style="{StaticResource ModernTextBoxStyle}"
                                        Height="34"
                                        Grid.Column="0"/>
                                <Button Content="üìÇ"
                                       Style="{StaticResource ModernIconButtonStyle}"
                                       Width="34"
                                       Height="34"
                                       Margin="8,0,0,0"
                                       Grid.Column="1"
                                       FontSize="14"
                                       Command="{Binding BrowseOutputFileCommand}"/>
                            </Grid>

                            <!-- Mem√≥ria -->
                            <TextBlock Text="Mem√≥ria (ex: -Xmx512m)" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <TextBox x:Name="MemoriaTextBox"
                                    Text="{Binding Memoria, UpdateSourceTrigger=PropertyChanged}"
                                    Style="{StaticResource ModernTextBoxStyle}"
                                    Height="34"
                                    Margin="0,0,0,12"/>

                            <!-- Etiquetas -->
                            <TextBlock Text="Etiquetas (separadas por v√≠rgula)" FontWeight="SemiBold" Margin="0,0,0,5"/>
                            <TextBox x:Name="EtiquetasTextBox"
                                    Text="{Binding Etiquetas, UpdateSourceTrigger=PropertyChanged}"
                                    Style="{StaticResource ModernTextBoxStyle}"
                                    Height="34"/>
                        </StackPanel>
                    </GroupBox>

                </StackPanel>
            </ScrollViewer>

            <!-- Splitter -->
            <GridSplitter Grid.Column="1"
                         Width="10"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Stretch"
                         Background="#E0E0E0"
                         ShowsPreview="True"/>

            <!-- Coluna Direita (Tabs) -->
            <Border Grid.Column="2" Background="White" BorderBrush="#DDD" BorderThickness="1" CornerRadius="8" Padding="10">
                <TabControl x:Name="RightTabControl"
                            SelectionChanged="RightTabControl_SelectionChanged"
                            SelectedIndex="{Binding SelectedTabIndex, Mode=TwoWay}">
                    <!-- Pr√©-valida√ß√£o Tab -->
                    <TabItem x:Name="PreValidacaoTab">
                        <TabItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="üîç" FontSize="16" VerticalAlignment="Center"/>
                                <TextBlock Text=" Pr√©-valida√ß√£o" Margin="5,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </TabItem.Header>
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" 
                                      Text="{Binding PreflightStatusText}"
                                      FontSize="14"
                                      FontWeight="SemiBold"
                                      Foreground="#1976D2"
                                      Margin="0,0,0,15"/>

                            <ListView x:Name="PreflightListView"
                                     Grid.Row="1"
                                     ItemsSource="{Binding PreflightChecks}"
                                     BorderThickness="0"
                                     Background="Transparent"
                                     ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Border Padding="10" Margin="0,0,0,8" Background="#F8F9FA" CornerRadius="4">
                                            <StackPanel>
                                                <TextBlock Text="{Binding Nome}" FontWeight="SemiBold" FontSize="13"/>
                                                <TextBlock Text="{Binding Detalhes}" TextWrapping="Wrap" Margin="0,4,0,0" FontSize="12"/>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>

                            <Button Grid.Row="2" 
                                   Content="üîÑ Reexecutar"
                                   Style="{StaticResource PrimaryButtonStyle}"
                                   Width="140" 
                                   Height="36"
                                   HorizontalAlignment="Right"
                                   Margin="0,15,0,0"
                                   Command="{Binding RunPreflightCheckCommand}"/>
                        </Grid>
                    </TabItem>

                    <!-- Ajuda Tab -->
                    <TabItem x:Name="AjudaTab">
                        <TabItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="üí°" FontSize="16" VerticalAlignment="Center"/>
                                <TextBlock Text=" Ajuda" Margin="5,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </TabItem.Header>
                        <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="15">
                            <StackPanel>
                                <TextBlock Text="Como usar" FontSize="18" FontWeight="Bold" Foreground="#1976D2" Margin="0,0,0,15"/>
                                
                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                    <Bold>1. Preencha os campos obrigat√≥rios (*)</Bold>
                                    <LineBreak/>
                                    Ano, M√™s, NIF, Password e Ficheiro SAF-T s√£o obrigat√≥rios.
                                </TextBlock>

                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                    <Bold>2. Selecione o ficheiro SAF-T</Bold>
                                    <LineBreak/>
                                    Clique no bot√£o üìÇ para escolher o ficheiro XML ou arquivo comprimido.
                                </TextBlock>

                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                    <Bold>3. Configure as op√ß√µes</Bold>
                                    <LineBreak/>
                                    Marque "Envio de Teste" para testar sem submeter oficialmente.
                                </TextBlock>

                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                    <Bold>4. Clique em ENVIAR</Bold>
                                    <LineBreak/>
                                    O resultado aparecer√° no separador "Resultado".
                                </TextBlock>

                                <Border Background="#FFF3E0" BorderBrush="#FFB300" BorderThickness="1" CornerRadius="4" Padding="12" Margin="0,20,0,0">
                                    <StackPanel>
                                        <TextBlock Text="‚ö†Ô∏è Importante" FontWeight="Bold" FontSize="14" Foreground="#F57C00"/>
                                        <TextBlock TextWrapping="Wrap" Margin="0,8,0,0">
                                            Certifique-se de que todos os campos obrigat√≥rios est√£o preenchidos antes de enviar.
                                            Se o bot√£o ENVIAR n√£o responder, verifique se preencheu todos os campos marcados com *.
                                        </TextBlock>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Resultado Tab -->
                    <TabItem x:Name="ResultadoTab">
                        <TabItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="üì¨" FontSize="16" VerticalAlignment="Center"/>
                                <TextBlock Text=" Resultado" Margin="5,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </TabItem.Header>
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Resumo -->
                            <Border Grid.Row="0" Background="#E8F5E9" BorderBrush="#4CAF50" BorderThickness="1" CornerRadius="4" Padding="12" Margin="0,0,0,10">
                                <TextBlock x:Name="OutputSummaryTextBlock"
                                          Text="{Binding OutputSummary}"
                                          TextWrapping="Wrap"
                                          FontSize="12"/>
                            </Border>

                            <!-- Output completo -->
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                <TextBox x:Name="OutputTextBlock"
                                        Text="{Binding OutputText}"
                                        IsReadOnly="True"
                                        TextWrapping="Wrap"
                                        BorderThickness="0"
                                        Background="Transparent"
                                        FontFamily="Consolas"
                                        FontSize="11"/>
                            </ScrollViewer>

                            <!-- A√ß√µes -->
                            <UniformGrid Grid.Row="2" Columns="3" Margin="0,10,0,0">
                                <Button x:Name="CopiarResultadoButton"
                                       Content="üìã Copiar"
                                       Style="{StaticResource SecondaryButtonStyle}"
                                       Command="{Binding CopiarResultadoCommand}"
                                       Margin="0,0,5,0"
                                       Height="38"/>
                                <Button x:Name="AbrirLogButton"
                                       Content="üìÑ Abrir Log"
                                       Style="{StaticResource SecondaryButtonStyle}"
                                       Command="{Binding AbrirUltimoLogCommand}"
                                       Margin="0,0,5,0"
                                       Height="38"/>
                                <Button x:Name="LimparResultadoButton"
                                       Content="üóëÔ∏è Limpar"
                                       Style="{StaticResource SecondaryButtonStyle}"
                                       Command="{Binding LimparResultadoCommand}"
                                       Height="38"/>
                            </UniformGrid>
                        </Grid>
                    </TabItem>

                    <!-- Hist√≥rico Tab -->
                    <TabItem x:Name="HistoricoTab">
                        <TabItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="üìä" FontSize="16" VerticalAlignment="Center"/>
                                <TextBlock Text=" Hist√≥rico" Margin="5,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </TabItem.Header>
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <DataGrid x:Name="HistoricoDataGrid"
                                     Grid.Row="0"
                                     ItemsSource="{Binding HistoricoFiltrado}"
                                     AutoGenerateColumns="False"
                                     IsReadOnly="True"
                                     HeadersVisibility="Column"
                                     GridLinesVisibility="None"
                                     AlternatingRowBackground="#F5F5F5"
                                     RowHeight="32">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Data/Hora" Binding="{Binding DataHora, StringFormat=dd/MM/yyyy HH:mm}" Width="130"/>
                                    <DataGridTextColumn Header="Empresa" Binding="{Binding EmpresaNome}" Width="*"/>
                                    <DataGridTextColumn Header="Opera√ß√£o" Binding="{Binding Operacao}" Width="80"/>
                                    <DataGridTextColumn Header="Resultado" Binding="{Binding Resultado}" Width="90"/>
                                </DataGrid.Columns>
                            </DataGrid>

                            <Border Grid.Row="1" Background="#E3F2FD" BorderBrush="#2196F3" BorderThickness="1" CornerRadius="4" Padding="10" Margin="0,10,0,10">
                                <TextBlock x:Name="HistoricoEstatisticasTextBlock" 
                                          Text="{Binding HistoricoEstatisticas}" 
                                          TextWrapping="Wrap" 
                                          FontSize="12"/>
                            </Border>

                            <UniformGrid Grid.Row="2" Columns="2">
                                <Button Content="üì• Exportar CSV"
                                       Style="{StaticResource SecondaryButtonStyle}"
                                       Command="{Binding ExportarHistoricoCommand}"
                                       Margin="0,0,5,0"
                                       Height="38"/>
                                <Button Content="üîÑ Limpar Filtros"
                                       Style="{StaticResource SecondaryButtonStyle}"
                                       Command="{Binding LimparFiltrosHistoricoCommand}"
                                       Height="38"/>
                            </UniformGrid>
                        </Grid>
                    </TabItem>

                    <!-- Sobre Tab -->
                    <TabItem x:Name="SobreTab">
                        <TabItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="‚ÑπÔ∏è" FontSize="16" VerticalAlignment="Center"/>
                                <TextBlock Text=" Sobre" Margin="5,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </TabItem.Header>
                        <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Image Source="/EnviaSaft.png" Height="80" Margin="0,0,0,20"/>
                                <TextBlock Text="EnvioSafT AT" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                                <TextBlock Text="{Binding AppVersion}" FontSize="14" HorizontalAlignment="Center" Foreground="#666" Margin="0,0,0,30"/>
                                
                                <TextBlock Text="Aplica√ß√£o para envio de ficheiros SAF-T para a Autoridade Tribut√°ria" 
                                          TextWrapping="Wrap" 
                                          TextAlignment="Center"
                                          Margin="0,0,0,20"/>
                                
                                <TextBlock HorizontalAlignment="Center">
                                    <Hyperlink NavigateUri="https://www.loadinghappiness.pt" RequestNavigate="Hyperlink_RequestNavigate">
                                        www.loadinghappiness.pt
                                    </Hyperlink>
                                </TextBlock>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>
            </Border>
        </Grid>

        <!-- Rodap√© com Ticker -->
        <Border Grid.Row="2" 
                x:Name="StatusTickerBorder" 
                Background="{Binding TickerType, Converter={StaticResource TickerTypeToColorConverter}}" 
                Padding="15,0">
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock x:Name="StatusTickerIcon" 
                              Text="‚ÑπÔ∏è" 
                              FontSize="16" 
                              Foreground="White" 
                              Margin="0,0,10,0"
                              VerticalAlignment="Center"/>
                    <TextBlock x:Name="StatusTicker" 
                              Text="{Binding TickerMessage}" 
                              Foreground="White" 
                              FontSize="13"
                              VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
